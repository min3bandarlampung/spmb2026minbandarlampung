<!doctype html>
<html lang="id" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPDB Online | MIN Se-Kota Bandar Lampung</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; scroll-behavior: smooth; }
        .gradient-bg { background: linear-gradient(135deg, #064e3b 0%, #065f46 50%, #064e3b 100%); }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .input-focus:focus { border-color: #10b981; ring: 2px; ring-color: #d1fae5; outline: none; }
    </style>
</head>
<body class="bg-gray-50 flex flex-col h-full">

    <nav class="gradient-bg text-white shadow-xl sticky top-0 z-50 no-print">
        <div class="max-w-7xl mx-auto px-4 h-20 flex justify-between items-center">
            <div class="flex items-center space-x-3 cursor-pointer" onclick="showPage('dashboard')">
                <div class="bg-white p-2 rounded-xl text-2xl">üéì</div>
                <div>
                    <h1 class="font-extrabold text-xl leading-none tracking-tight">SPMB 2026 ONLINE </h1>
                    <p class="text-[10px] text-emerald-300 font-bold uppercase tracking-widest">MIN Se-Kota Bandar Lampung</p>
                </div>
            </div>
            <div class="hidden md:flex items-center space-x-8 text-sm font-semibold">
                <button onclick="showPage('dashboard')" class="hover:text-emerald-300 transition">Beranda</button>
                <button onclick="showPage('cek-status')" class="hover:text-emerald-300 transition">Cek Kelulusan</button>
                <div id="nav-admin-login">
                    <button onclick="showPage('admin-login')" class="bg-white/10 px-5 py-2 rounded-full border border-white/20 hover:bg-white/20 transition">Admin</button>
                </div>
                <div id="nav-admin-logout" class="hidden flex items-center space-x-4">
                    <span class="text-emerald-300">Admin Mode</span>
                    <button onclick="logout()" class="bg-red-500 px-5 py-2 rounded-full font-bold hover:bg-red-600 shadow-lg transition">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="flex-grow">
        <section id="page-dashboard" class="page active">
            <div class="gradient-bg py-24 text-center text-white px-4">
                <h2 class="text-4xl md:text-6xl font-black mb-6 leading-tight">Selamat Datang di <br>SPMB Terpadu MIN Se-Kota Bandar Lampung</h2>
                <p class="text-emerald-100 max-w-2xl mx-auto mb-10 text-lg opacity-90">Daftarkan putra-putri Anda melalui jalur seleksi transparan berbasis usia di 12 Madrasah Ibtidaiyah Negeri terbaik.</p>
                <div id="dashboard-actions" class="flex flex-col md:flex-row justify-center gap-5">
                    </div>
            </div>
        </section>

        <section id="page-form-pendaftaran" class="page py-12 px-4">
            <div class="max-w-4xl mx-auto bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border border-gray-100">
                <div class="bg-gray-900 p-8 text-white flex justify-between items-center">
                    <div>
                        <h2 class="text-2xl font-black uppercase">Formulir Pendaftaran</h2>
                        <p class="text-emerald-400 text-xs font-bold tracking-widest mt-1">LENGKAPI DATA DENGAN BENAR</p>
                    </div>
                    <div class="text-right hidden md:block">
                        <p class="text-xs text-gray-400">TP 2024/2025</p>
                    </div>
                </div>

                <form id="form-daftar" onsubmit="handlePendaftaran(event)" class="p-8 md:p-12 space-y-12">
                    <div class="space-y-6">
                        <h3 class="text-gray-400 font-black text-xs uppercase tracking-[0.2em] flex items-center">
                            <span class="w-8 h-px bg-gray-200 mr-3"></span> 01. Pilihan Sekolah
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 bg-emerald-50 p-6 rounded-3xl border border-emerald-100 shadow-inner">
                            <div>
                                <label class="block text-xs font-black text-emerald-800 mb-2 uppercase">Prioritas 1</label>
                                <select id="p1" required class="w-full bg-white border-none p-3 rounded-xl text-sm font-bold focus:ring-2 focus:ring-emerald-500 outline-none"></select>
                            </div>
                            <div>
                                <label class="block text-xs font-black text-emerald-800 mb-2 uppercase">Prioritas 2</label>
                                <select id="p2" required class="w-full bg-white border-none p-3 rounded-xl text-sm font-bold focus:ring-2 focus:ring-emerald-500 outline-none"></select>
                            </div>
                            <div>
                                <label class="block text-xs font-black text-emerald-800 mb-2 uppercase">Prioritas 3</label>
                                <select id="p3" required class="w-full bg-white border-none p-3 rounded-xl text-sm font-bold focus:ring-2 focus:ring-emerald-500 outline-none"></select>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <h3 class="text-gray-400 font-black text-xs uppercase tracking-[0.2em] flex items-center">
                            <span class="w-8 h-px bg-gray-200 mr-3"></span> 02. Identitas Siswa
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="md:col-span-2">
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Nama Lengkap (Sesuai Akte)</label>
                                <input type="text" id="nama" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus" placeholder="Masukkan Nama Lengkap">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">NIK (16 Digit)</label>
                                <input type="text" id="nik" maxlength="16" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus" placeholder="352xxxxxxxxxxxxx">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Jenis Kelamin</label>
                                <select id="jk" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus">
                                    <option value="">Pilih...</option>
                                    <option value="Laki-laki">Laki-laki</option>
                                    <option value="Perempuan">Perempuan</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Tanggal Lahir</label>
                                <input type="date" id="tgl_lahir" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Agama</label>
                                <select id="agama" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus">
                                    <option value="Islam">Islam</option>
                                    <option value="Lainnya">Lainnya</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <h3 class="text-gray-400 font-black text-xs uppercase tracking-[0.2em] flex items-center">
                            <span class="w-8 h-px bg-gray-200 mr-3"></span> 03. Data Orang Tua & Alamat
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Nama Ayah</label>
                                <input type="text" id="nama_ayah" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Pekerjaan Ayah</label>
                                <input type="text" id="pekerjaan_ayah" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Nama Ibu</label>
                                <input type="text" id="nama_ibu" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Pekerjaan Ibu</label>
                                <input type="text" id="pekerjaan_ibu" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Nomor HP (WhatsApp)</label>
                                <input type="tel" id="hp" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus" placeholder="08xxxxxxxxxx">
                            </div>
                            <div class="md:col-span-2">
                                <label class="text-xs font-bold text-gray-500 mb-1 block">Alamat Lengkap</label>
                                <textarea id="alamat" rows="2" required class="w-full bg-gray-50 border-2 border-gray-100 p-4 rounded-2xl input-focus"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <h3 class="text-gray-400 font-black text-xs uppercase tracking-[0.2em] flex items-center">
                            <span class="w-8 h-px bg-gray-200 mr-3"></span> 04. Dokumen (PDF/JPG Max 2MB)
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-8 bg-blue-50 rounded-[2rem] border border-blue-100">
                            <div class="space-y-2">
                                <p class="text-[10px] font-black text-blue-900 uppercase">KK & Akte*</p>
                                <input type="file" required class="text-xs w-full file:bg-blue-600 file:text-white file:border-none file:rounded-lg file:px-3 file:py-1">
                            </div>
                            <div class="space-y-2">
                                <p class="text-[10px] font-black text-blue-900 uppercase">KTP Ortu*</p>
                                <input type="file" required class="text-xs w-full file:bg-blue-600 file:text-white file:border-none file:rounded-lg file:px-3 file:py-1">
                            </div>
                            <div class="space-y-2">
                                <p class="text-[10px] font-black text-blue-900 uppercase">Foto 3x4*</p>
                                <input type="file" required class="text-xs w-full file:bg-blue-600 file:text-white file:border-none file:rounded-lg file:px-3 file:py-1">
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-black py-5 rounded-[1.5rem] shadow-xl text-lg transition-all active:scale-95 uppercase tracking-widest">Kirim Pendaftaran</button>
                </form>
            </div>
        </section>

        <section id="page-bukti-daftar" class="page py-12 px-4">
            <div id="bukti-print-area" class="max-w-2xl mx-auto bg-white p-12 rounded-3xl shadow-xl border border-gray-100"></div>
            <div class="mt-8 text-center no-print flex justify-center space-x-4">
                <button onclick="downloadPDF()" class="bg-gray-900 text-white px-8 py-3 rounded-2xl font-bold shadow-lg">Download PDF</button>
                <button onclick="showPage('dashboard')" class="bg-gray-200 text-gray-700 px-8 py-3 rounded-2xl font-bold">Beranda</button>
            </div>
        </section>

        <section id="page-cek-status" class="page py-24 px-4">
            <div class="max-w-md mx-auto bg-white p-10 rounded-[3rem] shadow-2xl text-center">
                <div class="text-5xl mb-6">üîç</div>
                <h2 class="text-2xl font-black mb-2">Cek Kelulusan</h2>
                <p class="text-sm text-gray-400 mb-8">Hasil seleksi diproses berdasarkan kuota dan usia tertua.</p>
                <input type="text" id="search-nik" placeholder="352xxxxxxxxxxxxx" class="w-full bg-gray-50 border-2 border-gray-100 p-5 rounded-2xl mb-5 text-center text-xl font-bold input-focus">
                <button onclick="cekLulus()" class="w-full bg-emerald-600 text-white py-4 rounded-2xl font-bold text-lg shadow-lg">Lihat Hasil</button>
                <div id="status-result" class="mt-10"></div>
            </div>
        </section>

        <section id="page-admin-login" class="page py-24 px-4">
            <div class="max-w-sm mx-auto bg-white p-10 rounded-[3rem] shadow-2xl text-center">
                <div class="text-5xl mb-6">üîê</div>
                <h2 class="text-2xl font-black mb-6">Login Panel</h2>
                <input type="password" id="admin-pass" placeholder="Password Admin" class="w-full bg-gray-50 border-2 border-gray-100 p-5 rounded-2xl mb-5 text-center font-bold input-focus">
                <button onclick="loginAdmin()" class="w-full bg-gray-900 text-white py-4 rounded-2xl font-bold text-lg">Masuk Admin</button>
                <p class="text-[10px] text-gray-300 mt-4 italic font-bold uppercase tracking-widest">Password: admin123</p>
            </div>
        </section>

        <section id="page-admin-panel" class="page py-12 px-4">
            <div class="max-w-7xl mx-auto space-y-8">
                <div class="flex flex-col md:flex-row justify-between items-end gap-4">
                    <div>
                        <h2 class="text-3xl font-black text-gray-900 tracking-tight">Console Administrator</h2>
                        <p class="text-emerald-600 font-bold text-sm">Kelola pendaftaran & seleksi otomatis</p>
                    </div>
                    <button onclick="prosesSeleksi()" class="bg-orange-500 hover:bg-orange-600 text-white px-8 py-4 rounded-2xl font-black shadow-lg transition-all active:scale-95">üéØ JALANKAN SELEKSI OTOMATIS</button>
                </div>

                <div class="bg-white p-8 rounded-[2rem] shadow-xl border border-gray-100">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                        <div class="flex items-center space-x-4">
                            <div class="bg-orange-100 p-3 rounded-2xl text-2xl">üìÖ</div>
                            <div>
                                <h3 class="font-black text-gray-800 uppercase text-sm tracking-widest">Gerbang Pendaftaran</h3>
                                <p class="text-xs text-gray-400">Tentukan kapan calon siswa bisa mendaftar</p>
                            </div>
                        </div>
                        <div class="flex bg-gray-100 p-1.5 rounded-2xl border w-full md:w-auto">
                            <button id="btn-open" onclick="toggleReg(true)" class="flex-1 px-8 py-3 rounded-xl font-black transition text-xs">üîì BUKA</button>
                            <button id="btn-close" onclick="toggleReg(false)" class="flex-1 px-8 py-3 rounded-xl font-black transition text-xs">üîí TUTUP</button>
                        </div>
                    </div>
                </div>

                <div id="admin-stats" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>

                <div class="bg-white p-8 rounded-[2rem] shadow-xl border border-gray-100">
                    <div class="flex justify-between items-center mb-8">
                        <h3 class="font-black text-gray-800 text-sm tracking-[0.2em] uppercase flex items-center">
                            <span class="w-8 h-px bg-gray-200 mr-3"></span> Pengaturan Kuota
                        </h3>
                        <button onclick="saveQuotas()" class="text-emerald-600 font-black text-xs hover:underline uppercase tracking-widest">üíæ Simpan Data Kuota</button>
                    </div>
                    <div id="quota-input-container" class="grid grid-cols-2 md:grid-cols-6 gap-4"></div>
                </div>

                <div class="bg-white rounded-[2rem] shadow-xl overflow-hidden border border-gray-100">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 text-[10px] font-black uppercase text-gray-500 tracking-widest">
                                <tr>
                                    <th class="p-6">Pendaftar</th>
                                    <th class="p-6">Info Personal</th>
                                    <th class="p-6">Pilihan Utama</th>
                                    <th class="p-6">Hasil</th>
                                </tr>
                            </thead>
                            <tbody id="admin-table-body" class="divide-y divide-gray-50 text-sm"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-white border-t py-12 text-center no-print">
        <p class="text-xs font-black text-gray-400 uppercase tracking-[0.3em]">&copy; 2026 MIN 3 Bandar Lampung</p>
    </footer>

    <script>
        // State Management
        let pendaftar = JSON.parse(localStorage.getItem('min_ppdb_v3')) || [];
        let configKuota = JSON.parse(localStorage.getItem('min_quota_v3')) || {
            "MIN 1": 20, "MIN 2": 20, "MIN 3": 20, "MIN 4": 20, "MIN 5": 20, "MIN 6": 20,
            "MIN 7": 20, "MIN 8": 20, "MIN 9": 20, "MIN 10": 20, "MIN 11": 20, "MIN 12": 20
        };
        let isRegOpen = JSON.parse(localStorage.getItem('min_reg_open')) ?? true;

        // Init
        function init() {
            initSelects();
            updateGlobalUI();
        }

        function initSelects() {
            ['p1', 'p2', 'p3'].forEach(id => {
                const el = document.getElementById(id);
                el.innerHTML = '<option value="">Pilih MIN...</option>';
                Object.keys(configKuota).forEach(min => {
                    el.innerHTML += `<option value="${min}">${min}</option>`;
                });
            });
        }

        function showPage(id) {
            if (id === 'form-pendaftaran' && !isRegOpen) {
                alert("Mohon maaf, pendaftaran sedang ditutup.");
                return;
            }
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + id).classList.add('active');
            window.scrollTo(0,0);
            if (id === 'admin-panel') renderAdmin();
        }

        // Logic Pendaftaran
        function handlePendaftaran(e) {
            e.preventDefault();
            const nik = document.getElementById('nik').value;
            if (nik.length !== 16) return alert("NIK harus 16 digit!");
            if (pendaftar.some(p => p.nik === nik)) return alert("NIK ini sudah terdaftar!");

            const data = {
                id: 'PPDB-' + Date.now(),
                nama: document.getElementById('nama').value,
                nik: nik,
                jk: document.getElementById('jk').value,
                tgl_lahir: document.getElementById('tgl_lahir').value,
                ayah: document.getElementById('nama_ayah').value,
                hp: document.getElementById('hp').value,
                alamat: document.getElementById('alamat').value,
                p1: document.getElementById('p1').value,
                p2: document.getElementById('p2').value,
                p3: document.getElementById('p3').value,
                status: 'Antrian Seleksi',
                sekolah_diterima: '',
                waktu: new Date().toISOString()
            };

            pendaftar.push(data);
            localStorage.setItem('min_ppdb_v3', JSON.stringify(pendaftar));
            renderBukti(data);
            showPage('bukti-daftar');
        }

        function renderBukti(data) {
            document.getElementById('bukti-print-area').innerHTML = `
                <div class="text-center border-b-8 border-double border-gray-900 pb-6 mb-8">
                    <h1 class="text-2xl font-black uppercase tracking-tighter">Kartu Bukti Pendaftaran</h1>
                    <p class="text-[10px] font-bold text-emerald-600 uppercase tracking-widest">MIN Se-Kota Bandar Lampung TP 2026/2027</p>
                </div>
                <div class="grid grid-cols-2 gap-y-4 text-sm font-medium">
                    <div class="text-gray-400 uppercase text-[10px]">No. Register</div><div class="font-black text-gray-900">${data.id}</div>
                    <div class="text-gray-400 uppercase text-[10px]">Nama Siswa</div><div class="font-black text-gray-900">${data.nama}</div>
                    <div class="text-gray-400 uppercase text-[10px]">NIK</div><div>${data.nik}</div>
                    <div class="text-gray-400 uppercase text-[10px]">Tgl Lahir</div><div>${data.tgl_lahir}</div>
                    <div class="text-gray-400 uppercase text-[10px]">No. HP / WA</div><div>${data.hp}</div>
                </div>
                <div class="mt-8 bg-gray-50 p-6 rounded-3xl border-2 border-dashed border-gray-200">
                    <p class="text-[10px] font-black text-gray-400 mb-3 uppercase tracking-widest text-center">Urutan Pilihan Madrasah</p>
                    <div class="flex justify-around font-bold text-gray-700 text-xs">
                        <span>1. ${data.p1}</span>
                        <span>2. ${data.p2}</span>
                        <span>3. ${data.p3}</span>
                    </div>
                </div>
            `;
        }

        // Admin: Control
        function toggleReg(status) {
            isRegOpen = status;
            localStorage.setItem('min_reg_open', JSON.stringify(status));
            updateGlobalUI();
            alert(status ? "Gerbang Pendaftaran DIBUKA" : "Gerbang Pendaftaran DITUTUP");
        }

        function updateGlobalUI() {
            const container = document.getElementById('dashboard-actions');
            if (isRegOpen) {
                container.innerHTML = `
                    <button onclick="showPage('form-pendaftaran')" class="bg-emerald-500 hover:bg-emerald-400 text-white px-12 py-5 rounded-2xl font-black text-lg shadow-2xl transition-all">üìù DAFTAR SEKARANG</button>
                    <button onclick="showPage('cek-status')" class="bg-white/10 hover:bg-white/20 text-white px-12 py-5 rounded-2xl font-black text-lg backdrop-blur-md border border-white/20 transition-all">üîç CEK KELULUSAN</button>
                `;
                document.getElementById('btn-open').className = "flex-1 px-8 py-3 rounded-xl font-black bg-emerald-500 text-white shadow-lg";
                document.getElementById('btn-close').className = "flex-1 px-8 py-3 rounded-xl font-black text-gray-400";
            } else {
                container.innerHTML = `
                    <div class="bg-red-500/20 border border-red-500 text-white px-12 py-5 rounded-2xl font-black text-lg backdrop-blur-md">üîí PENDAFTARAN DITUTUP</div>
                    <button onclick="showPage('cek-status')" class="bg-white/10 hover:bg-white/20 text-white px-12 py-5 rounded-2xl font-black text-lg backdrop-blur-md border border-white/20 transition-all">üîç CEK KELULUSAN</button>
                `;
                document.getElementById('btn-open').className = "flex-1 px-8 py-3 rounded-xl font-black text-gray-400";
                document.getElementById('btn-close').className = "flex-1 px-8 py-3 rounded-xl font-black bg-red-500 text-white shadow-lg";
            }
        }

        function saveQuotas() {
            document.querySelectorAll('.q-input').forEach(i => configKuota[i.dataset.min] = parseInt(i.value) || 0);
            localStorage.setItem('min_quota_v3', JSON.stringify(configKuota));
            alert("Kuota disimpan!");
            renderAdmin();
        }

        function prosesSeleksi() {
            if (!confirm("Jalankan seleksi usia otomatis?")) return;
            let sorted = [...pendaftar].sort((a, b) => new Date(a.tgl_lahir) - new Date(b.tgl_lahir));
            let sisa = {...configKuota};
            
            sorted.forEach(s => {
                s.status = 'Belum Lulus'; s.sekolah_diterima = '';
                const p = [s.p1, s.p2, s.p3];
                for (let sk of p) {
                    if (sisa[sk] > 0) {
                        s.status = 'Lulus'; s.sekolah_diterima = sk;
                        sisa[sk]--; break;
                    }
                }
            });
            pendaftar = sorted;
            localStorage.setItem('min_ppdb_v3', JSON.stringify(pendaftar));
            renderAdmin();
            alert("Seleksi Selesai!");
        }

        function renderAdmin() {
            // Stats
            const lulus = pendaftar.filter(p => p.status === 'Lulus').length;
            document.getElementById('admin-stats').innerHTML = `
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-50"><p class="text-[9px] font-black text-gray-400 uppercase">Pendaftar</p><h4 class="text-2xl font-black">${pendaftar.length}</h4></div>
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-50"><p class="text-[9px] font-black text-emerald-400 uppercase">Lulus</p><h4 class="text-2xl font-black text-emerald-600">${lulus}</h4></div>
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-50"><p class="text-[9px] font-black text-red-400 uppercase">Antre</p><h4 class="text-2xl font-black text-red-500">${pendaftar.length - lulus}</h4></div>
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-50"><p class="text-[9px] font-black text-blue-400 uppercase">Sekolah</p><h4 class="text-2xl font-black">12</h4></div>
            `;
            // Quota
            const qc = document.getElementById('quota-input-container'); qc.innerHTML = '';
            Object.keys(configKuota).forEach(m => {
                qc.innerHTML += `<div class="bg-gray-50 p-3 rounded-2xl border"><label class="block text-[8px] font-black text-gray-400 uppercase mb-1">${m}</label>
                    <input type="number" data-min="${m}" value="${configKuota[m]}" class="q-input w-full bg-transparent font-bold text-center outline-none"></div>`;
            });
            // Table
            const tb = document.getElementById('admin-table-body'); tb.innerHTML = '';
            pendaftar.forEach(s => {
                tb.innerHTML += `<tr class="hover:bg-gray-50 transition">
                    <td class="p-6 font-bold">${s.nama}<br><span class="text-[9px] text-gray-400">${s.nik}</span></td>
                    <td class="p-6 text-xs text-gray-500">${s.jk}<br>${s.tgl_lahir}</td>
                    <td class="p-6 text-xs font-bold">${s.p1}</td>
                    <td class="p-6"><span class="px-3 py-1 rounded-full text-[9px] font-black uppercase ${s.status === 'Lulus' ? 'bg-emerald-100 text-emerald-700' : 'bg-gray-100 text-gray-400'}">${s.status} ${s.sekolah_diterima}</span></td>
                </tr>`;
            });
        }

        function cekLulus() {
            const nik = document.getElementById('search-nik').value;
            const data = pendaftar.find(p => p.nik === nik);
            const res = document.getElementById('status-result');
            if (!data) { res.innerHTML = `<p class="text-red-500 font-bold text-xs">Data tidak ditemukan!</p>`; return; }
            const isL = data.status === 'Lulus';
            res.innerHTML = `<div class="p-8 rounded-[2rem] border-4 border-dashed ${isL ? 'border-emerald-500 bg-emerald-50' : 'border-gray-100 bg-gray-50'}">
                <p class="text-[10px] font-black uppercase text-gray-400 mb-2">Status Akhir:</p>
                <h3 class="text-3xl font-black ${isL ? 'text-emerald-700' : 'text-gray-400'}">${data.status.toUpperCase()}</h3>
                ${isL ? `<p class="text-xs font-bold text-emerald-600 mt-2 uppercase tracking-widest">DI ${data.sekolah_diterima}</p>` : `<p class="text-xs text-gray-400 mt-2">Tetap pantau status hingga akhir seleksi.</p>`}
            </div>`;
        }

        function loginAdmin() {
            if (document.getElementById('admin-pass').value === 'admin123') {
                document.getElementById('nav-admin-login').classList.add('hidden');
                document.getElementById('nav-admin-logout').classList.remove('hidden');
                showPage('admin-panel');
            } else { alert("Salah!"); }
        }

        function logout() { location.reload(); }
        function downloadPDF() {
            const element = document.getElementById('bukti-print-area');
            html2pdf().from(element).set({ margin: 1, filename: 'SPMB_2026_Bukti.pdf', html2canvas: { scale: 3 }, jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' } }).save();
        }

        init();
    </script>
</body>
</html>